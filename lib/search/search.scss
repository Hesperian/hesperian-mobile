@use "../css/theme.scss" as *;

$seachbar-icon-color: $subnavbar-bg-hex;
$seachbar-icon-color-preview: 000000;
$searchbar-icon: url("data:image/svg+xml;charset=utf-8,%3Csvg%20fill%3D'%23#{$seachbar-icon-color}'%20height%3D'24'%20viewBox%3D'0%200%2024%2024'%20width%3D'24'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%3E%3Cpath%20d%3D'M15.5%2014h-.79l-.28-.27C15.41%2012.59%2016%2011.11%2016%209.5%2016%205.91%2013.09%203%209.5%203S3%205.91%203%209.5%205.91%2016%209.5%2016c1.61%200%203.09-.59%204.23-1.57l.27.28v.79l5%204.99L20.49%2019l-4.99-5zm-6%200C7.01%2014%205%2011.99%205%209.5S7.01%205%209.5%205%2014%207.01%2014%209.5%2011.99%2014%209.5%2014z'%2F%3E%3Cpath%20d%3D'M0%200h24v24H0z'%20fill%3D'none'%2F%3E%3C%2Fsvg%3E");
$input-clear-button: url("data:image/svg+xml;charset=utf-8,%3Csvg%20fill%3D'%23#{$seachbar-icon-color}'%20height%3D'24'%20viewBox%3D'0%200%2024%2024'%20width%3D'24'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%3E%3Cpath%20d%3D'M19%206.41L17.59%205%2012%2010.59%206.41%205%205%206.41%2010.59%2012%205%2017.59%206.41%2019%2012%2013.41%2017.59%2019%2019%2017.59%2013.41%2012z'%2F%3E%3Cpath%20d%3D'M0%200h24v24H0z'%20fill%3D'none'%2F%3E%3C%2Fsvg%3E");
$searchbar-icon-preview: url("data:image/svg+xml;charset=utf-8,%3Csvg%20fill%3D'%23#{$seachbar-icon-color-preview}'%20height%3D'24'%20viewBox%3D'0%200%2024%2024'%20width%3D'24'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%3E%3Cpath%20d%3D'M15.5%2014h-.79l-.28-.27C15.41%2012.59%2016%2011.11%2016%209.5%2016%205.91%2013.09%203%209.5%203S3%205.91%203%209.5%205.91%2016%209.5%2016c1.61%200%203.09-.59%204.23-1.57l.27.28v.79l5%204.99L20.49%2019l-4.99-5zm-6%200C7.01%2014%205%2011.99%205%209.5S7.01%205%209.5%205%2014%207.01%2014%209.5%2011.99%2014%209.5%2014z'%2F%3E%3Cpath%20d%3D'M0%200h24v24H0z'%20fill%3D'none'%2F%3E%3C%2Fsvg%3E");
$input-clear-button-preview: url("data:image/svg+xml;charset=utf-8,%3Csvg%20fill%3D'%23#{$seachbar-icon-color-preview}'%20height%3D'24'%20viewBox%3D'0%200%2024%2024'%20width%3D'24'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%3E%3Cpath%20d%3D'M19%206.41L17.59%205%2012%2010.59%206.41%205%205%206.41%2010.59%2012%205%2017.59%206.41%2019%2012%2013.41%2017.59%2019%2019%2017.59%2013.41%2012z'%2F%3E%3Cpath%20d%3D'M0%200h24v24H0z'%20fill%3D'none'%2F%3E%3C%2Fsvg%3E");

/*
md .searchbar .input-clear-button:after {
    line-height: 48px;
    content: "delete_round_md"; "delete_md"
    opacity: 1;
    */
// Override F7 v8 CSS variables to match v3.6 flat appearance
:root {
  --f7-searchbar-input-bg-color: transparent;
  --f7-searchbar-input-border-radius: 0;
  --f7-searchbar-input-border-width: 0;
  --f7-searchbar-bg-color: transparent;
  --f7-searchbar-inner-padding-left: 0;
  --f7-searchbar-inner-padding-right: 0;
  --f7-searchbar-search-icon-color: white;
}

// Global navbar searchbar - pill-shaped white input
#app .navbar .subnavbar .searchbar {
  flex-grow: 1;
  // Constrain height to prevent overflow past subnavbar border and searchbar input border
  // Total offset = subnavbar border (2px) + searchbar input border (2px) = 4px
  max-height: calc(var(--f7-subnavbar-height) - var(--hm-subnavbar-border-width) - var(--hm-searchbar-input-border-width));

  .searchbar-inner {
    padding: var(--hm-searchbar-inset, 3px) 10%;
    display: flex;
    align-items: center;
    transition: padding 0.3s ease;
    // Ensure inner content respects parent height
    height: 100%;
    box-sizing: border-box;
  }

  &.searchbar-focused .searchbar-inner {
    padding: var(--hm-searchbar-inset, 3px) 8px;
  }

  .searchbar-input-wrap {
    background-color: var(--hm-searchbar-input-background, white);
    border-radius: 20px;
    padding: 4px 16px;
    display: flex;
    align-items: center;
    box-sizing: border-box;
    height: calc(100% - 2 * var(--hm-searchbar-inset, 3px));

    // Focus ring on the pill-shaped wrapper instead of the input,
    // so it's visible against the white background and follows the pill shape
    &:has(input:focus-visible) {
      outline: 2px solid var(--hm-focus-color-secondary) !important;
      outline-offset: 0 !important;
      box-shadow: 0 0 0 4px var(--hm-focus-color) !important;
    }

    input[type="search"] {
      color: var(--hm-searchbar-input-text-color, black);
      background: transparent;
      line-height: 24px;
      height: 24px;
      order: 2;
      flex: 1;
      text-align: start;
      // Reset F7 padding - we handle icon positioning with flexbox order
      padding-inline-start: 0;
      // Add padding-end to balance the search icon (24px + 8px margin) for centered placeholder
      // Use smaller value to avoid clipping text on narrow screens
      padding-inline-end: 16px;

      &:focus {
        padding-inline-end: 0;
      }

      &:focus-visible {
        outline: none !important;
        box-shadow: none !important;
      }

      &::placeholder {
        color: var(--hm-searchbar-input-text-color, black);
        text-align: center;
      }

    }

    .searchbar-icon,
    .input-clear-button {
      position: static;
      width: 24px;
      height: 24px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 0;

      &:after {
        color: $subnavbar-bg;
        line-height: 24px;
      }
    }

    .searchbar-icon {
      margin-right: 8px;
      order: 1;
    }

    .input-clear-button {
      margin-left: 8px;
      order: 3;
    }
  }
}

.inline-icons {
  .f7-icons {
    font-size: 24px;
  }
}

#app .searchbar .input-clear-button:after {
  content: "delete_md";
}

#app .searchbar input[type="search"]::placeholder {
  font-size: 110%;
}

#app .searchbar-local {
  border: 1px solid $heading-border;
  border-radius: 2px;
  margin: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
}

#app .searchbar-local .searchbar-icon:after {
  color: $heading-border;
}

.searchbar-icon-preview {
  width: 1.75em;
  height: 1.75em;
  background-image: $searchbar-icon-preview;
}


#app .searchbar .search-disable-button {
  padding-left: 10px;
  padding-right: 10px;
  display: none;
}

#app.local-search-enabled .searchbar .search-disable-button {
  display: inherit;
}

.local-search-list {
  display: none;
}

#app.local-search-enabled .local-search-list {
  display: inherit;
}


#app.local-search-enabled .searchbar-hide-on-local-search {
  display: none;
}

#app .local-search-list .search-link {
  display: none;
}

#app .local-search-list .search-link.search-passes {
  display: inherit;
}