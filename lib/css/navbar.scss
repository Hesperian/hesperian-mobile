/*
 *  navbar.scss
 */

@use "./theme.scss" as *;


// Framework7 CSS variables
:root {
  --f7-navbar-height: 64px;
  --f7-subnavbar-height: 48px;
  --f7-toolbar-height: 48px;
  --f7-navbar-bg-color: #{$navbar-bg};
  // Border widths for subnavbar and searchbar input
  --hm-subnavbar-border-width: 2px;
  --hm-searchbar-input-border-width: 2px;
}

// Fix for toolbar at bottom of DOM (after page-content) for accessibility
// Framework7's .toolbar-bottom ~ * selector only works when toolbar precedes siblings
// Use :has() to set the offset when page contains a bottom toolbar
.page:has(.toolbar-bottom-md.app-toolbar) {
  --f7-page-toolbar-bottom-offset: var(--f7-toolbar-height);
}

// Also handle safe-area-inset-bottom for the toolbar itself when at bottom
.toolbar-bottom-md.app-toolbar {
  padding-bottom: env(safe-area-inset-bottom);
}

#app .toolbar {
  .button {
    border: none;
  }
}


#app .navbar {
  color: $navbar-text;
  border: 0px;
}

#app .navbar a,
#app .toolbar a {
  color: white;
  padding-left: 16px;
  padding-right: 16px;
}

// Make some room for close link
#app .popup .navbar .navbar-inner,
#app .smart-select-popup .navbar .navbar-inner {
  padding-left: 16px;
  padding-right: 16px;
}

#app .navbar .subnavbar {
  border-bottom: var(--hm-subnavbar-border-width) solid $subnavbar-bg;

  a {
    color: $navbar-text;
  }
}

#app .navbar .subnavbar,
.navbar .searchbar {
  background-color: white;

  .searchbar-input-wrap {
    border: var(--hm-searchbar-input-border-width) solid $subnavbar-bg;
  }
}

.back>i {
  font-weight: bolder;
}

.global-search {
  display: none;
}

#app.global-search-in .global-search {
  display: inherit;
}

/* Center the navbar title even in md theme */
.navbar .title {
  display: flex;
  justify-content: center;
  position: relative;
  flex-grow: 1;
  max-height: 100%;
  overflow: visible;

  // Focus style for Hesperian logo link
  a:has(.hesperian-logo-image) {
    display: flex;
    align-items: flex-end;
    gap: 6px;
    padding-bottom: 4px;
    text-decoration: none;
    font-size: 24px;
    font-weight: 400;
    letter-spacing: 0.5px;

    &:focus,
    &:focus-visible {
      outline: 2px solid var(--hm-focus-color-secondary) !important;
      outline-offset: 0 !important;
      box-shadow: 0 0 0 4px var(--hm-focus-color) !important;
    }
  }
}

.navbar .title .hesperian-logo-image {
  height: 45px;
  align-self: center;
}

/* Disable f7 horizontal rules */
.navbar:after {
  display: none;
}

// Symmetric spacing for navbar left/right icon containers
$navbar-icon-edge-spacing: 8px;
// Width for icon columns (ensures back button aligns with menu icon)
$navbar-icon-column-width: 52px;

// Primary navbar row - use fixed width for left/right to align with secondary navbar
.navbar .left {
  width: $navbar-icon-column-width;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.navbar .right {
  width: $navbar-icon-column-width;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

// Override default link padding for icon-only buttons in navbar
.navbar .left .link.icon-only,
.navbar .right .link.icon-only {
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

// Secondary navbar uses grid with same column width for alignment
// Note: F7 adds 4px horizontal margin to .navbar .left/.right, so we add matching padding
.navbar .secondary-navbar {
  display: grid;
  grid-template-columns: $navbar-icon-column-width 1fr $navbar-icon-column-width;
  align-items: center;
  // Match the 4px margin that F7 adds to .navbar .left
  padding-left: 4px;
  padding-right: 4px;

  > .back-button {
    grid-column: 1;
    justify-self: center;
    // Reset margins since grid handles positioning
    margin-left: 0;
    margin-right: 0;
  }

  > .subnavbar-inner {
    grid-column: 2;
  }
}

.navbar {
  border-color: #efeff4;
  border-style: solid;
  border-width: 8px 8px 0px 8px;
  background-color: var(--hm-top-safe-area-color);

  .navbar-inner {
    background-color: var(--f7-navbar-bg-color);
    background-clip: content-box;
  }
}

.secondary-navbar>.subnavbar-inner {
  padding-left: 0px;
  padding-right: 0px;
}

// Back button styling in secondary navbar
#app .navbar .secondary-navbar>.back-button {
  // Remove default link padding to allow proper grid centering
  padding: 0;

  &>i {
    color: $subnavbar-bg;
    font-size: 28px;
    font-weight: bold;
  }
}

/* Navbar Back and Menu buttons */
.navbar-f7-icons {
  font-weight: bold;
  color: white;
}

/* Navbar dropdown icons */
.navbar .top-left-menu .icon,
.navbar .top-right-menu .icon {
  background-color: $navbar-bg;
  width: 36px;
  height: 36px;
  min-width: 36px;
  min-height: 36px;
  aspect-ratio: 1 / 1;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 32px;
  font-weight: bold;
}


.navbar-right {
  margin-left: auto;
}

.navbar-home-title {
  padding-left: 10px;
}


/* Content pages */
.page.content ul,
.page.content ol {
  padding-left: 20px;
}

.page.content ul>li,
.page.content ol>li {
  margin-bottom: 10px;
}

// toolbar
#app {
  .app-toolbar {
    background-color: $subnavbar-bg;

    .material-icons {
      font-size: 28px;
    }

    a {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    &:not(.hm-audio-enabled) a.toolbar-audio-button-play {
      display: none;
    }
  }

  .favorites-sheet {
    .toolbar {
      background-color: $subnavbar-bg;
    }
  }
}